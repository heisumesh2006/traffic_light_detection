<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>üöó YOLO + Gemini Voice Assistant</title>
    <style>
        body {
            margin: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #0f172a;
            /* dark navy */
            color: #e2e8f0;
            /* light gray text */
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start;
            min-height: 100vh;
        }

        h1 {
            color: #60a5fa;
            /* light blue */
            margin: 30px 0 10px;
            font-size: 2rem;
            text-align: center;
        }

        #video {
            border: 4px solid #3b82f6;
            /* blue border */
            border-radius: 10px;
            margin-bottom: 20px;
            box-shadow: 0px 4px 10px rgba(0, 0, 0, 0.5);
        }

        #output {
            background-color: #1e293b;
            /* dark gray-blue */
            color: #f1f5f9;
            /* very light text */
            padding: 15px 20px;
            border-radius: 10px;
            max-width: 640px;
            font-size: 1.1rem;
            text-align: left;
            box-shadow: 0px 4px 10px rgba(0, 0, 0, 0.5);
            white-space: pre-line;
        }
    </style>
</head>

<body>
    <h1>üö¶ YOLO + Gemini Voice Assistant</h1>
    <img id="video" src="{{ url_for('video_feed') }}" width="640" height="480" />
    <p id="output">‚è≥ Waiting for detection...</p>

    <script>
        function updateInfo() {
            fetch('/latest_detection')
                .then(response => response.json())
                .then(data => {
                    const output = document.getElementById('output');

                    if (data.detection) {
                        const msg = `üîç ${data.detection} detected at ${data.distance}m.\n\nüí¨ Gemini says: ${data.response}`;
                        output.innerText = msg;

                        const speak = new SpeechSynthesisUtterance(data.response);
                        speechSynthesis.speak(speak);
                    } else {
                        output.innerText = "‚ö†Ô∏è No traffic light detected yet.";
                    }
                });
        }

        setInterval(updateInfo, 4000);
    </script>
</body>

</html>